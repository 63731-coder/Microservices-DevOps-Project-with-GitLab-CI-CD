stages:
  - build
  - test

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository"

# Job de compilation du service Java
build-java:
  stage: build
  image: maven:3.9-eclipse-temurin-17
  script:
    - cd service-java
    - mvn -B clean package -DskipTests
  artifacts:
    paths:
      - service-java/target/

# Job de test du service Java
test-java:
  stage: test
  image: maven:3.9-eclipse-temurin-17
  script:
    - cd service-java
    - mvn test

# Job de test du service Python
test-python:
  stage: test
  image: python:3.11-slim
  before_script:
    - cd service-python
    - pip install -r requirements.txt
  script:
    - python test_app.py

